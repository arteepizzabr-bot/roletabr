<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roleta Premiada üé∞</title>
<style>
body {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    background: radial-gradient(circle at center, #111 40%, #000 100%);
    font-family: "Arial Black", sans-serif;
    color: #fff;
}
h1 {
    margin-bottom: 20px;
    color: gold;
    text-shadow: 0 0 15px red, 0 0 30px orange;
}
canvas {
    border: 10px solid gold;
    border-radius: 50%;
    background: #222;
    box-shadow: 0 0 30px rgba(255,215,0,0.8), inset 0 0 20px #000;
}
#spin {
    margin-top: 20px;
    padding: 15px 40px;
    font-size: 20px;
    background: linear-gradient(45deg, red, darkred);
    color: #fff;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    text-transform: uppercase;
    font-weight: bold;
    letter-spacing: 2px;
    box-shadow: 0 0 15px red, 0 0 25px orange inset;
    transition: 0.2s;
}
#spin:hover {
    background: linear-gradient(45deg, darkred, red);
    transform: scale(1.05);
}
#spin:disabled {
    background: gray;
    cursor: not-allowed;
    box-shadow: none;
}
#message {
    margin-top: 25px;
    font-size: 22px;
    font-weight: bold;
    color: gold;
    text-shadow: 0 0 12px red, 0 0 25px orange;
}
</style>
</head>
<body>
<h1>üé∞ Gire a Roleta da Sorte üé∞</h1>
<canvas id="wheel" width="400" height="400"></canvas>
<button id="spin">Girar Agora</button>
<div id="message"></div>

<audio id="tick" src="tick-1.mp3" preload="auto"></audio>
<audio id="win" src="applause-8.mp3" preload="auto"></audio>
<audio id="lose" src="boo-01.mp3" preload="auto"></audio>

<script>
const options = [
    "5% DE DESCONTO",
    "10% DE DESCONTO",
    "15% DE DESCONTO",
    "N√ÉO FOI DESSA VEZ",
    "ENTREGA GR√ÅTIS",
    "REFRI GR√ÅTIS",
    "GIRE DE NOVO",
    "20% DE DESCONTO"
];

let canvas = document.getElementById("wheel");
let ctx = canvas.getContext("2d");
let startAngle = 0;
let arc = (2 * Math.PI) / options.length;
let spinTimeout = null;

function drawWheel() {
    ctx.clearRect(0, 0, 400, 400);
    for (let i = 0; i < options.length; i++) {
        let angle = startAngle + i * arc;
        ctx.fillStyle = i % 2 === 0 ? "#e63946" : "#f1faee";
        ctx.beginPath();
        ctx.moveTo(200, 200);
        ctx.arc(200, 200, 200, angle, angle + arc, false);
        ctx.lineTo(200, 200);
        ctx.fill();

        ctx.save();
        ctx.translate(200, 200);
        ctx.rotate(angle + arc / 2);
        ctx.fillStyle = i % 2 === 0 ? "#fff" : "#000";
        ctx.font = "bold 16px Arial";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(options[i], 120, 0);
        ctx.restore();
    }

    // Marcador dourado invertido verticalmente
    ctx.fillStyle = "gold";
    ctx.beginPath();
    ctx.moveTo(200, 400);   // invertido: ponta para baixo
    ctx.lineTo(195, 380);
    ctx.lineTo(205, 380);
    ctx.closePath();
    ctx.fill();
}

drawWheel();

const spinBtn = document.getElementById("spin");
const message = document.getElementById("message");
const tickSound = document.getElementById("tick");
const winSound = document.getElementById("win");
const loseSound = document.getElementById("lose");

const today = new Date().toISOString().split("T")[0];
const lastSpin = localStorage.getItem("lastSpinDate");
const lastPrize = localStorage.getItem("lastPrize");
if (lastSpin === today) {
    spinBtn.disabled = true;
    message.innerText = `Voc√™ j√° girou hoje! üéÅ Pr√™mio: ${lastPrize}`;
}

function rotateWheel(spinAngle, spinTime, spinTimeTotal) {
    spinTime += 30;
    if (spinTime >= spinTimeTotal) {
        stopRotateWheel(spinAngle);
        return;
    }
    let spinAngleIncrement = easeOut(spinTime, 0, spinAngle, spinTimeTotal);
    startAngle += (spinAngleIncrement * Math.PI) / 180;
    drawWheel();

    tickSound.currentTime = 0;
    tickSound.play();

    spinTimeout = setTimeout(() => rotateWheel(spinAngle, spinTime, spinTimeTotal), 30);
}

function stopRotateWheel(spinAngle) {
    clearTimeout(spinTimeout);
    let degrees = (startAngle * 180) / Math.PI + 90;
    let arcd = (arc * 180) / Math.PI;
    let index = Math.floor((360 - (degrees % 360)) / arcd);
    let prize = options[index];

    localStorage.setItem("lastSpinDate", today);
    localStorage.setItem("lastPrize", prize);
    spinBtn.disabled = true;

    if (prize.includes("N√ÉO FOI")) {
        message.innerText = `üò¢ ${prize}`;
        loseSound.play();
    } else if(prize.includes("GIRE DE NOVO")) {
        message.innerText = `üîÑ ${prize}!`;
        spinBtn.disabled = false;
    } else {
        message.innerText = `üéâ Voc√™ ganhou: ${prize}!`;
        winSound.play();
    }
}

function easeOut(t, b, c, d) {
    let ts = (t /= d) * t;
    let tc = ts * t;
    return b + c * (tc + -3 * ts + 3 * t);
}

spinBtn.addEventListener("click", () => {
    let spinAngle = 2000 + Math.random() * 2000;
    rotateWheel(spinAngle, 0, 5000);
});
</script>
</body>
</html>